<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Mendel Game</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap css theme --> 
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300;400;500;600;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Oxanium:wght@200;400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,200;0,300;1,200&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gugi&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400&display=swap" rel="stylesheet">

    <!-- Fa icons -->
    <link rel="stylesheet" href="css/all.css">

    <!-- Custom css -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/game.css">

</head>
<body style='overflow: hidden !important;'>

    <div id='container-4-bg' style='height: 100vh; width: 100vw;'>
        <div id='preload-images'></div>

        <!-- Graph area -->
        <svg width="1000" height="700" id="svg-main" style='display: none; position: absolute; top:0; left:0;'></svg>
        
        <!-- Loading screen -->
        <div id='loading-screen'>
            <div class='w-100 h-100 d-flex flex-column justify-content-center align-items-center text-center fnt-safe'>

                <!-- Progress bar -->
                <div id='loading-div'>
                    <h5 id='loading-text'> Loading ... </h5>
                    <div class="progress">
                        <div class="progress-bar progress-bar-striped progress-bar-animated bg-primary col-dark fnt-safe" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" id='loading-progress'></div>
                    </div>
                </div>
                
                <!-- Start game button -->
                <button type='button' class='btn btn-lrg btn-custom-outline p-3 fnt-safe' id='screen-button'>
                    <h1 style='margin: 0;'> Start <i class="fas fa-play" id='screen-arrow'></i> </h1>
                </button>

            </div>
        </div>

        <!-- Main title -->
        <div id='splash'>
            <div class='w-100 h-100 d-flex justify-content-center align-items-center text-center fnt-safe'>
                <h1 id='splash-title'>MENDEL</h1>
                <img id='splash-logo' src='images/logo v5_white.png' height='150px' width='150px' style='display: inline-block;'>
            </div>
        </div>
        <div id='splash-login'>
            <div class='card m-2 p-2 bg-light' id='splash-login-box'>     
                <input class='m-2 bg-light' type="text" id="splash-form" name="fname" placeholder=" Enter username">
                <button class='btn btn-lg m-2 btn-custom' id='splash-button'>Login</button>
            </div>
        </div>
        <div id='splash-planet'></div> <!-- Planet -->
        
        <!-- Planet image -->
        <div id='GUI-planet'></div>
        <p id='progress-helpText' style='display: none; position: absolute; top:0; left: 45%;'><i class="far fa-hand-pointer col-primary"></i>  Enact policies to make progress.</p>
        
        <!-- Current planet, system and goal information -->
        <div id='GUI-planetInfo' class='d-flex flex-column justify-content-center'>

            <!-- Current planet-->
            <div id='GUI-currentPlanet-div'>
                <h1 id='GUI-currentPlanet' class='display-4'>
                    Level 1
                </h1>
            </div>

            <!-- Current system -->
            <div id='progress-goal-div-div'>
                <div class="progress center-block position-relative" id='progress-goal-div' style='cursor: pointer;'>
                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-primary" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width: 75%; color: rgba(0,0,0,0); text-shadow: none;" id='progress-goal'></div>
                    <h5 class="justify-content-center d-flex position-absolute w-100 mt-1" id='GUI-currentSystem' style='font-weight: 600;'>
                        Aeries system
                    </h5>
                </div>
            </div>

            <!-- Current goal -->
            <div id='GUI-goal' class='p-2'>
                <h5 id='GUI-goal-h'>Goal:</h5>
                <p class='p-2' id='GUI-goal-p'>
                    <img id='goal-icon' src='images/epicons/sleep.png' class='m-2' style='height: 30px; width: auto;'>
                    <i class='' id='goal-indicator'></i>
                    <span id='goal'>Increase sleep</span>
                </p>
            </div> 
            
            <!-- Intervention effects 
            <div id='GUI-policyEffects' class='p-2'>

                <h5 class='p-1 text-center' id='GUI-policyEffects-title'>
                   Side-effects
                </h5>

                <div id='policyEffects-sideeffects'>

                    <div class='policyEffect'>
                        <p class='p-2'>
                            <img src='images/epicons/sleep.png' class='m-2 policyEffect-icon' style='height: 30px; width: auto;'>
                            <i class="col-pos"></i>
                            <span>Increased heart disease</span>
                        </p>
                    </div>   
                    <div class='policyEffect'>
                        <p class='p-2'>
                            <img src='images/epicons/sleep.png' class='m-2 policyEffect-icon' style='height: 30px; width: auto;'>
                            <i class="col-pos"></i>
                            <span>Increased education</span>
                        </p>
                    </div>   

                </div> -->

                <!-- Button to continue 
                <button id='policyEffects-button' class='btn btn-lrg btn-custom-outline mt-3'>Next level <i class="fas fa-chevron-right"></i> <i class="fas fa-globe-africa"></i></button>
                -->
            </div>
        </div>  

        <!-- Intervention dialogue
        <div class="modal" tabindex="-1" role="dialog" id='intervention-modal'>
            <div class="modal-dialog modal-sm" role="document">
              <div class="modal-content">
                <div class="modal-header" style='border: none;'>
                  <h5 class="modal-title">
                    <i class="fas fa-crosshairs"></i> Intervention
                  </h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                    <div class='d-flex flex-row align-items-center justify-content-center'>
                            
                        <form id='intervention-direction-form'>

                            <label class='p-3'>
                                <input type="radio" name="direction" value="Increase" checked>
                                <i class="fas fa-caret-up"></i>
                                <br>
                                Increase
                            </label>
                            
                            <label class='p-3'>
                                <input type="radio" name="direction" value="Reduce">
                                <i class="fas fa-caret-down"></i>
                                <br>
                                Reduce
                            </label>
    
                        </form>
                    </div>
                </div>
                <div class="modal-footer" style='border: none;'>
                  <button id='intervention-btn' type="button" class="w-100 btn btn-lrg btn-custom" data-dismiss="modal" data-nodeId='ieu_a_1239'>
                      <i class="fas fa-dna"></i> 
                      <span id='intervention-direction'>Increase</span> 
                      <span id='intervention-text'>education</span>
                    </button>
                </div>
              </div>
            </div>
            <div class='d-flex flex-row justify-content-center align-items-center'> 
            -->
                <!-- Tutorial 
                <div id='tutorial-5' class='card tutorial' style='min-width: 500px;'>
                    <div class='row'>
                        <div class='col-md-3 d-flex justify-content-center align-items-center'>
                            <i class="fas fa-arrow-up" style='font-size: 3em;'></i>
                        </div>
                        <div class='col-md-9'>
                            <p class='p-2'>
                                Use the 
                                <i class="fas fa-caret-up"></i>
                                <i class="fas fa-caret-down"></i> 
                                buttons to select either an increase or decrease.
                                <br>
                                <strong>Raise education to improve intelligence</strong>
                            </p>
                        </div>
                    </div>
                    <button id='tutorial-5-btn' class='btn w-100 btn-lrg btn-custom'>Dismiss</button>
                </div>

            </div>
        </div> -->

        <!-- Win screen -->
        <div id='win-screen' class='w-100 h-100' style='position: absolute; top:0px; left:0px; overflow: auto;'>
            <div class='d-flex flex-column h-100 align-items-center justify-content-center'>
                <div class='card p-3 fnt-light' id='win-screen-div'>
                    <!-- Header -->
                    <h3 class='text-center m-2 fnt-bold'><i class="fas fa-calendar-check"></i> Policy enacted!</h3>
              
                    <div id='win-screen-notice'></div>
                    <!-- Interventions in policy -->
                    <h4 class='mt-4'>Leaderboard: <em id='win-objective'></em></h4>
                    <div id='win-effects-player-intervention' class='p-2 d-flex flex-row justify-content-center'></div>
                    <div id='win-effects-best-intervention' class='p-2 d-flex flex-row justify-content-center'></div>                    
                    
                    <!-- Continue button -->
                    <button id='win-screen-btn' class='m-2 btn w-100 btn-lrg btn-custom'>Continue</button>
    
                </div>
            </div>

        </div>

        <!-- Level up modal -->
        <div class="modal" tabindex="-1" role="dialog" id='modal-lvlup'>
            <div class="modal-dialog modal-dialog-scrollable" role="document">
              <div class="modal-content">
                <div class="modal-header" style='border: none;'>
                  <div class="modal-title">
                      <h1><i class="fas fa-fire"></i> Unlockable abilities</h1>                  
                      <p class='text-muted'>Every time you level up you can unlock an ability to power up your interventions.</p>
                  </div>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body" id='levelup-content'>
                        <div id='levelup-notice'></div>

                        <form id='unlocks'>
                            <div class='d-flex flex-column justify-content-around'>
                            
                            <div>
                                <h4>Number of interventions</h4>
                                <p class='text-muted'>Increase the number of interventions that you can make at the same time.</p>
                            </div>

                            <div class='d-flex flex-row align-items-center justify-content-center'>


                                <label class='unlock' id='ul-max-1'>
                                    <input type="radio" name="max" id='ul-max-1-rd' value=1 checked>
                                    <i class="fas fa-plus" id='ul-max-1-i'></i>
                                    <br>
                                    1
                                </label>
                                
                                <label class='unlock' id='ul-max-2'>
                                    <input type="radio" name="max" id='ul-max-2-rd' value=2 disabled>
                                    <i class="fas fa-plus" id='ul-max-2-i'></i>
                                    <br>
                                    2
                                </label>
                                
                                <label class='unlock' id='ul-max-3'>
                                    <input type="radio" name="max" id='ul-max-3-rd' value=3 disabled>
                                    <i class="fas fa-plus" id='ul-max-3-i'></i>
                                    <br>
                                    3
                                </label>

                                
                                <label class='unlock' id='ul-max-4'>
                                    <input type="radio" name="max" id='ul-max-4-rd' value=4 disabled>
                                    <i class="fas fa-plus" id='ul-max-4-i'></i>
                                    <br>
                                    4
                                </label>

                            </div>

                            <div>
                                <h4>Strength of interventions</h4>
                                <p class='text-muted'>Increase the amount that your interventions change a trait.</p>
                            </div>

                            <div class='d-flex flex-row align-items-center justify-content-center'>

                                <label class='unlock' id='ul-mult-2'>
                                    <input type="radio" name="strength" id='ul-mult-2-rd' value=1 checked>
                                    <i class="fas fa-times"id='ul-mult-2-i'></i>
                                    <br>
                                    30%
                                </label>
                                
                                <label class='unlock' id='ul-mult-3'>
                                    <input type="radio" name="strength" id='ul-mult-3-rd' value=1.5 disabled>
                                    <i class="fas fa-times"id='ul-mult-3-i'></i>
                                    <br>
                                    50%
                                </label>
                                
                                <label class='unlock' id='ul-mult-4'>
                                    <input type="radio" name="strength" id='ul-mult-4-rd' value=2 disabled>
                                    <i class="fas fa-times"id='ul-mult-4-i'></i>
                                    <br>
                                    70%
                                </label>

                                <label class='unlock' id='ul-mult-5'>
                                    <input type="radio" name="strength" id='ul-mult-5-rd' value=2.5 disabled>
                                    <i class="fas fa-times"id='ul-mult-5-i'></i>
                                    <br>
                                    100%
                                </label>

                            </div>
    
                        </div>
                    </form>
                </div>
                <div class="modal-footer" style='border: none;'>
                    <button id='modal-lvlup-btn' type="button" class="w-100 btn btn-lrg btn-custom" data-dismiss="modal">Continue</button>
                </div>
              </div>
            </div>
            <div class='d-flex flex-row justify-content-center align-items-center'>
                <!-- Space for tutorial dialog -->
            </div>
        </div>

        <!-- Legend -->
        <div class='' style='position: absolute; left:0; bottom:0; z-index: 99;' id='legend_key'>
            <div class='card p-2' style='background: rgba(248, 248, 255, 0.9)'>
                <h5>Key</h5><br>
                <p class='col-pos'><i class="fas fa-arrow-right"></i> = Increase </p>
                <p class='col-neg'><i class="fas fa-arrow-right"></i> = Decrease </p>
            </div>
        </div>

    </div><!-- / container-->

    <!-- Developer mode modal -->
    <div class="modal" tabindex="-1" role="dialog" id='dev-modal'>
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Developer preview mode</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <p>Choose a mode to preview:</p>
              <button type="button" class="btn btn-custom m-2" data-dismiss="modal" id='dev-btn-3'>Interactive visualisation</button><br> 
              <button type="button" class="btn btn-custom m-2" data-dismiss="modal" id='dev-btn-4'>Game</button><br>
            </div>
            <div class="modal-footer">
                <small class='text-muted'></small>
            </div>
          </div>
        </div>
    </div>

    <!-- Test interface -->
    <div id='test_settings' style='position: absolute; top:0; left:0; display: none; z-index: 99;'>

        <!-- Input form for setting objective and interventions --> 
        <h3>Settings</h3>
        <em>Set an objective and intervention settings</em><br><br>
        <form >
            <label for="objective">Objective ID:</label>
            <input type="text" id="objective" name="objective" onchange="gameData.setObjective(this.value);highlightNode(this.value, fill='coral')" value="set objective trait"><br><br>
            <label for="interventions">Max number of interventions:</label>
            <input type="text" id="interventions" name="interventions" value="1"><br><br>
        </form>
        <hr>

        <!-- Interventions -->
        <h3>Active interventions:</h3>
        <div id='test_interventions'></div><br><br>
        <em>Click a trait to intervene on it</em><br>
        <hr>

        <!-- Output display for results of intervention --> 
        <h3>Results</h3>
        <em>View the effects of interventions here.</em><br><br>

        <h5>Objective score 
            <a data-content="% change in objective trait's prevalence" data-toggle="popover" title="Objective score calculation" class="btn btn-sm btn-info">
                <i class="fas fa-question"></i>
            </a>:
        </h5>
        <span id='test_score_objective'>-</span><br>

        <h5>Side-effect score 
            <a data-content="% increase to the prevalence of good traits, and decrease to bad traits in the network" data-toggle="popover" title="Side-effect score calculation" class="btn btn-sm btn-info">
                <i class="fas fa-question"></i>
            </a>:
        </h5>
        </h5><span id='test_score_goodness'>-</span><br><br>

        <h5>Intervention effects:</h5> <div id='test_allEffects' style='height: 200px; overflow: scroll;'></div><br>

        <!-- Reset button -->
        <button id='test_reset' class='btn btn-lrg btn-custom' onclick="gamestates[gameState].action(); reset();">Reset <i class="fas fa-undo-alt"></i></button>

    </div>

    <!-- Reset button for IV -->
    <button id='iv_reset' class='btn btn-lrg btn-custom' onclick="reset();" style='position: absolute; left:0; top:0; z-index: 10; display: none;' >Reset <i class="fas fa-undo-alt"></i></button>

    <!-- Modals -->
    <div id='modals'></div>    

    <!-- Endgame -->
    <div class="modal" tabindex="-1" role="dialog" id='endgame-modal' style='background: black !important;'>
        <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">You win! <i class="fas fa-crown"></i></h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
                <p>
                    You reached level 6. <i class="fas fa-fire"></i>
                    <br><br>
                    You reached and beat the final level!
                    If you are participating in a study please return to the questionnaire now <i class="fas fa-align-right"></i>
                </p>
            </div>
            <div class="modal-footer">
                <p>Thank you for playing!</p>
            </div>
          </div>
        </div>
      </div>

    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    
    <!-- External dependencies (Bootstrap, JQuery, D3, jsnetworkx) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="scripts/d3/d3.min.js"></script>
    <script src="https://d3js.org/d3-color.v2.min.js"></script>
    <script src="https://d3js.org/d3-interpolate.v2.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v2.min.js"></script>
    <script src="scripts/jsnx/jsnetworkx.js"></script>
    <script src="scripts/big/big.min.js"></script>

    <!-- Preload assets -->
    <script src='scripts/preload-assets.js'></script>
    <script src='scripts/preload.js'></script>

    <!-- Utilities -->
    <script src='scripts/utilities.js'></script>

    <!-- GUI modules -->
    <script src="scripts/edit-element.js"></script>
    <script src="scripts/create-element.js"></script>
    <script src="scripts/event-handling.js"></script>
    <script src="test/debug/debug-methods.js"></script> 

    <!-- Data -->    
    <script src="data/data-classes.js"></script> 
    <script src="data/data-tutorial.js"></script> 
    <script src="data/dataNew.js"></script>
    <script src="data/node-info.js"></script>
    <script src="data/standardise.js"></script>

    <!-- MiRANA network visualisation -->
    <script src="../mirana/scripts/settings-defaults.js"></script>
    <script src="../mirana/scripts/graph.js"></script>
    <script src="../mirana/scripts/edit-graph.js"></script>
    <script src="../mirana/scripts/data-cleaning.js"></script>
    <script src="../mirana/scripts/node-properties.js"></script>
    <script src="../mirana/scripts/edge-properties.js"></script>
    <script src="../mirana/scripts/graph-from-json.js"></script>

    <!-- Settings for network vis-->
    <script src="scripts/settings.js"></script>

    <!-- Propagation modules -->
    <script src="algorithms/traversal.js"></script>
    <script src="algorithms/mr-prop.js"></script>
    <script src="algorithms/loop-detection.js"></script>
    <script src="scripts/propagate.js"></script>
    <script src="algorithms/optimal-interventions.js"></script>

    <!-- Game Audio -->
    <script src="audio/audio.js"></script>

    <!-- Game Visuals -->
    <script src="scripts/planet-names.js"></script>
    <script src="scripts/animate-propagation.js"></script>

    <!-- Game Database -->
    <script src="data/database.js"></script> 

    <!-- Secondary scripts: Game modules --> 
    <script src="scripts/notifications.js"></script> 
    <script src="scripts/effects-readout.js"></script> 
    <script src="scripts/winscreen.js"></script>
    <script src="scripts/intro.js"></script> 
    <script src="scripts/tutorial.js"></script> 
    <script src="scripts/scoring.js"></script> 
    <script src="scripts/menu.js"></script> 

    <!-- Main scripts: MVC -->
    <script src="scripts/startup-game.js"></script> 
    <script src="scripts/model.js"></script> 
    <script src="scripts/view.js"></script> 
    <script src="scripts/controller.js"></script> 
    <script src="scripts/main.js"></script> 

</body>
</html>